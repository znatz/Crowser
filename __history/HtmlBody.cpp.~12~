#pragma hdrstop

#include "HtmlBody.h"

HtmlBody::HtmlBody()
{
	StrStr = new TStringStream();
	bodySize = 0;
}

void HtmlBody::SetBody(char* buff, int startPos,int endPos)
{
	StrStr->Write(&buff[startPos],endPos);
	cBody = StrStr->DataString;
	bodySize += endPos-startPos;
	Destruct();
}

void HtmlBody::SaveToFile(UnicodeString fn)
{
	StrStr->SaveToFile(fn);
}

void HtmlBody::Destruct()
{
	bStruct  		= new TAG;
	TAG	*tempRoot	= new TAG;
	TAG	*tempList;
	int tempPos;
	UnicodeString tempBody = cBody;
//do
//	{
		tempRoot->LStartPos    = tempBody.Pos("<");
		tempRoot->NameEndPos   = tempBody.Pos(" ");
		tempRoot->LEndPos      = tempBody.Pos(">");
		tempRoot->TagName 	   = tempBody.SubString(tempRoot->LStartPos+1,tempRoot->NameEndPos-1);
		tempRoot->RStartPos    = tempBody.Pos("</"+tempRoot->TagName+">");
		if (tempRoot->RStartPos!=0)
		{
		  tempRoot->REndPos	= tempRoot->RStartPos + tempRoot->TagName.Length() + 2;
		  tempBody 			= tempBody.SubString(tempRoot->LEndPos+1,tempRoot->RStartPos-1);
		}
		else
		{
		  tempRoot->REndPos	= ,tempBody.Length();
		  tempBody			= tempBody.SubString(tempRoot->LEndPos+1,tempRoot->REndPos);
		 }
//	}while();
}


/*
    GET / HTTP/1.1
    Host:localhost
    Connection:close


*/
